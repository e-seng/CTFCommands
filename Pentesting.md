# Pentesting

## Common Scans

### Initial, quick port scan

`nmap -vv -sV -sC -oN initial <ip>`

### Slower, complete port scan

`nmap -vv -sV -sC -p- -A -oN full <ip>`

### SMB

#### Finds SMB Vulnerabilities

`nmap -sC -sV -p<port> <ip> --script=smb-vuln*`

#### Enumerates SMB

`smbclient -L \\\\<ip>\\ -N`

### Directories

#### Gobuster directories scan (using wordlist)
`gobuster dir -e -u <ip> -w <path_to_wordlist>`

## SUID Bit Escalation

`find / -perm -u=s -type f 2>/dev/null`

`getcap -r / 2>/dev/null`

Once you have found different programs and SUID bits to be exploited, you can find default steps to spawn shells and other things at this website: https://gtfobins.github.io/

## Shell Upgrading

Once you have a reverse shell on a machine with python (or python3) available, you can try running these commands to upgrade the shell:

`python -c 'import pty; pty.spawn("/bin/bash")'`

`python3 -c 'import pty; pty.spawn("/bin/bash")'`

## Enumerate Writable Folders
`find / -writable 2>/dev/null | cut -d "/" -f 2 | sort -u`

## Hydra Password Brute Force

`hydra -l username -p passwordlist.txt <target>`

## Wordpress Scans

### Enumerates Users

`wpscan --url <ip>/<directory> -e u`

### Brute Forces Passwords

`wpscan --url <ip>/<directory> --passwords <password_list> --username <user>`

## SMB Commands

### List Network Shares

`smbclient -L <ip>`

### Connect To Share

`smbclient \\\\<ip>\\<share_name>`


## NFS Exploit

### 1. Check to see if there are any folders running on the machine that indicate they can be mounted to.
`showmount -e <ip>`

```
Export list for 10.10.60.230:
/srv/nfs *
```
The star indicates that anyone can mount to this folder. If that was not true, there would be a list of IPs that were allowed to mount to it.

### 2. Make a temp directory to mount to the filesystem.
`mkdir /tmp/infosec`

### 3. Mount to that directory and see what is inside, and if you can upload files.
`sudo mount -t nfs <ip>:/<directory> /tmp/infosec`
